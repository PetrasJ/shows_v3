{% set time = month|date("U") %}
{% if userWatchedEpisodes is defined %}
<button title="{{ userWatchedEpisodes|length }}" data-toggle="tooltip" class="showhide btn btn-default"><i
        class="fa fa-eye" aria-hidden="true"></i> {{ 'calendar.watched'|trans }}</button>{% endif %}
{% if userCalendarShowArchived is defined and userCalendarShowArchived != false %}
<button class='btn legend-icon legend-archived alert-danger' id=hide_archived data-toggle="tooltip"
        title='{{ 'calendar.show/hide archived shows'|trans }}'><i class="fa fa-eye" aria-hidden="true"></i>
    </button>{% endif %}
{% if userCalendarShowWatchlater is defined and userCalendarShowWatchlater != false %}
<button class="btn legend-icon legend-watchlater alert-success" id="hide_watchlater" data-toggle="tooltip"
        title='{{ 'calendar.show/hide watch later shows'|trans }}'><i class="fa fa-eye" aria-hidden="true"></i>
    </button>{% endif %}

<table class="table table-bordered table-striped calendar">
    <thead>
    <tr>
        <th colspan="7" class="center month-nav">
            {{ time|date('Y') }} {{ ('calendar.'~time|date('F'))|trans }}
        </th>
    </tr>
    <tr class="weekdays">
        <th style="width:15%">{{ 'calendar.Monday'|trans }}</th>
        <th style="width:15%">{{ 'calendar.Tuesday'|trans }}</th>
        <th style="width:14%">{{ 'calendar.Wednesday'|trans }}</th>
        <th style="width:14%">{{ 'calendar.Thursday'|trans }}</th>
        <th style="width:14%">{{ 'calendar.Friday'|trans }}</th>
        <th style="width:14%">{{ 'calendar.Saturday'|trans }}</th>
        <th style="width:14%">{{ 'calendar.Sunday'|trans }}</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        {% set daysInMonth = time|date('t') %}{% set startDow = time|date('F 1\\s\\t Y')|date('N') - 1 %}{% set dow = startDow %}{% for day in range(1,daysInMonth) %}{% set currentDay = time|date('Y-m') ~ '-' ~ '%02d'|format(day) %}{% if loop.first and startDow != 0 %}
        <td colspan="{{ startDow }}"></td>{% endif %}{% set break = false %}
        {% if app.user.username is defined %}
        <td class="day{% for episode in episodes if break == false %}{% if episode.userAirstamp|slice(0, 10) == currentDay %} exists{% set break = true %}{% endif %}{% endfor %}{% if currentDay=="now"|date('Y-m-d') %} current-day border-primary{% endif %}">
            <div class="inner">{% for episode in episodes %}{% if episode.userAirstamp|slice(0, 10) == currentDay %}
                <div class="episode{{ episode|class }}">
                    {% include '_inc/episode-details-time.html.twig' with {episode: episode} %}

                    <a href="{{ url('shows_details',{'userShowId': episode.userShowId}) }}" title="{{ episode.name }}">{{ episode.showName }}</a>
                    </div>{% endif %}{% endfor %}
            </div>

            <span class="dayoftheweek">{{ currentDay|date('Y-m-d') }} {{ ('calendar.'~currentDay|date('l'))|trans }}</span>
            <span class="day">{{ day }}</span>
        </td>
        {% else %}
            <td class="day{% for episode in episodes if break == false %}{% if episode.airstamp|date('Y-m-d') == currentDay %} exists{% set break = true %}{% endif %}{% endfor %}{% if currentDay=="now"|date('Y-m-d') %} current-day border-primary{% endif %}">
                <div class="inner">{% for episode in episodes %}{% if episode.airstamp|date('Y-m-d') == currentDay %}
                    <div class="episode">
                        {{ episode.airstamp|date('Y-m-d h:i') }}
                        <span title="{{ episode.name }}">{{ episode.showName }}</span>
                        </div>{% endif %}{% endfor %}
                </div>

                <span class="dayoftheweek">{{ currentDay|date('Y-m-d') }} {{ ('calendar.'~currentDay|date('l'))|trans }}</span>
                <span class="day">{{ day }}</span>
            </td>

        {% endif %}
        {% if loop.last and dow != 6 %}
            <td colspan="{{ 6 - dow }}">&nbsp;</td>
        {% endif %}{% if dow == 6 %}{% set dow = 0 %}
    </tr>
    <tr>
        {% else %}
            {% set dow = dow + 1 %}
        {% endif %}{% endfor %}
    </tr>
    </tbody>
</table>
